<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>歌詞加空格工具</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; font-family: "PingFang TC", "Noto Sans CJK", sans-serif; }
    body {
      margin: 0;
      background: linear-gradient(135deg,#eacda3,#d6ae7b);
      padding: 20px;
    }
    h1 {
      font-size: 32px;
      font-weight: 900;
    }
    .wrap {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 20px;
      margin-top: 30px;
      align-items: start;
    }
    textarea {
      width: 100%;
      height: 70vh;
      padding: 25px;
      border-radius: 18px;
      border: none;
      outline: none;
      font-size: 22px;
      line-height: 1.7;
      resize: none;
    }
    .btns {
      display: flex;
      flex-direction: column;
      gap: 25px;
      margin: 0 10px;
    }
    button {
      padding: 18px 30px;
      font-size: 22px;
      border-radius: 40px;
      border: none;
      cursor: pointer;
      font-weight: 700;
      color: white;
    }
    .b1 { background: #f7a18a; }
    .b2 { background: #2e79ff; }
    .b3 { background: #ffa75e; }
    .b4 { background: #e63946; }
    .b5 { background: #1abc9c; }
  </style>
</head>

<body>
<h1>歌詞加空格 made by 姚船長</h1>

<div class="wrap">
  <textarea id="input"></textarea>

  <div class="btns">
    <button class="b1" onclick="pasteText()">貼上</button>
    <button class="b2" onclick="convert()">轉換</button>
    <button class="b3" onclick="copyResult()">複製</button>
    <button class="b4" onclick="clearText()">清空</button>
    <button class="b5" onclick="oneClick()">一鍵完成</button>
  </div>

  <textarea id="output"></textarea>
</div>

<script>
  // 只對中文（CJK）加空格，英文不拆字
  function addSpacesToLyrics(text) {
    const isCJK = ch =>
      /[\u4E00-\u9FFF\u3400-\u4DBF\uF900-\uFAFF]/.test(ch);

    return text
      .split('\n')
      .map(line => {
        const chars = [...line];
        let out = '';

        for (let i = 0; i < chars.length; i++) {
          const curr = chars[i];
          const next = chars[i + 1];

          out += curr;

          if (!next) continue;
          if (curr === ' ' || next === ' ') continue;

          if (isCJK(curr) && isCJK(next)) {
            out += ' ';
          }
        }
        return out;
      })
      .join('\n');
  }

  function pasteText() {
    navigator.clipboard.readText().then(text => {
      document.getElementById("input").value = text;
    });
  }

  function convert() {
    const input = document.getElementById("input").value;
    const result = addSpacesToLyrics(input);
    document.getElementById("output").value = result;
  }

  function copyResult() {
    const text = document.getElementById("output").value;
    navigator.clipboard.writeText(text);
    alert("已複製!");
  }

  function clearText() {
    document.getElementById("input").value = "";
    document.getElementById("output").value = "";
  }

  function oneClick() {
    pasteText();
    setTimeout(convert, 150);
    setTimeout(copyResult, 350);
  }
</script>

</body>
</html>
